{% macro example(params) %}
  {% set exampleRef = params.example | default("default") %}
  {% set exampleURL = "/design-library/" + params.item + "/" + exampleRef + "/" %}
  {% set examplePath = "src" + exampleURL + "index.njk" %}
  {% set exampleId = "example-" + exampleRef %}
  {% set description = params.description %}
  {% if params.welsh %}
    {% set welshExampleRef = params.welsh | default("default") %}
    {% set welshExampleURL = "/design-library/" + params.item + "/" + welshExampleRef + "/" %}
    {% set welshExamplePath = "src" + welshExampleURL + "index.njk" %}
  {% endif %}
  <div class="app-example-wrapper app-example__language-switch--en-activated" id="{{ exampleId }}" data-module="app-tabs app-language-switch-example">
    <div class="app-example app-example--tabs">
      <span class="app-example__link app-example__new-window">
        <a href="{{ exampleURL }}" target="_blank" title="Open {{description}} example in a new window">
          Open this example in a new window
        </a>
      </span>
      {% if welshExampleURL %}
        <span class="app-example__link app-example__language-switch app-example__language-switch--current">
          <a href="{{ exampleURL }}" data-lang="en" target="_blank" data-track="lang-switch-en" title="Display {{description}} example in English">
            Display in English
          </a>
        </span>
        <span class="app-example__link app-example__language-switch js-enabled">
          <a href="{{ welshExampleURL }}" data-lang="cy" target="_blank" data-track="lang-switch-cy" title="Display {{description}} example in Welsh">
            Display in Welsh
          </a>
        </span>
      {% endif %}
      <iframe data-module="app-example-frame" class="app-example__frame app-example__frame--resizable"
              src="{{ exampleURL }}"{% if description %} title="{{description}} example"{% endif %}></iframe>
    </div>

    <div class="example-{{ exampleId }}-lang example-{{ exampleId }}-lang--en ">
      <span id="options-{{ exampleId }}"></span>
      <ul class="app-tabs" role="tablist">
        <li class="app-tabs__item js-tabs__item" role="presentation">
          <a href="#{{ exampleId }}-html" role="tab"
            aria-controls="{{ exampleId }}-html"
            data-track="tab-html" title="Display {{description}} example as HTML">HTML</a>
        </li>
        <li class="app-tabs__item js-tabs__item" role="presentation">
          <a href="#{{ exampleId }}-nunjucks" role="tab"
            aria-controls="{{ exampleId }}-nunjucks"
            data-track="tab-nunjucks" title="Display {{description}} example as Nunjucks">Nunjucks</a>
        </li>
      </ul>

      <div class="app-tabs__container js-tabs__container" id="{{ exampleId }}-html" role="tabpanel">
        <pre data-module="app-copy" class="app-example__language-switch--en-only-content"><code class="hljs html">
          {{- getHTMLCode(examplePath) | highlight('html') | safe -}}
        </code></pre>
        {% if welshExamplePath %}
          <pre data-module="app-copy" class="app-example__language-switch--cy-only-content"><code class="hljs html">
          {{- getHTMLCode(welshExamplePath) | highlight('html') | safe -}}
        </code></pre>
        {% endif %}
      </div>

      <div class="app-tabs__container js-tabs__container" id="{{ exampleId }}-nunjucks" role="tabpanel">
          <pre data-module="app-copy" class="app-example__language-switch--en-only-content"><code class="hljs js">
            {{- getNunjucksCode(examplePath) | highlight('js') | safe -}}
          </code></pre>
        {% if welshExamplePath %}
          <pre data-module="app-copy" class="app-example__language-switch--cy-only-content"><code class="hljs js">
            {{- getNunjucksCode(welshExamplePath) | highlight('js') | safe -}}
          </code></pre>
        {% endif %}
      </div>
    </div>
  </div>
{% endmacro %}
